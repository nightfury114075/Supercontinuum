function [betas,D]=dispersion(lambda,n_eff,N,del_lambda,N_pump)
  c = 3e-7; 						% Unit of velocity (c) of light is km/ps 
Beta02 = zeros(1,N);
for k = 2:N-1
  Beta02(k) = 1/(2*pi*c.^2)*lambda(k).^3*(n_eff(k+1)-2*n_eff(k)+n_eff(k-1))/del_lambda^2;	% [Unit:ps^2/km]
end

D = zeros(1,N);
for k = 2:N-1 
  D(k) = -2*1e-12*pi*c/lambda(k).^2*Beta02(k);		% [Unit:ps/nm/km]
end

Beta03 = zeros(1,N);
for k = 2:N-2
  Beta03(k) = -1/(4*pi^2*c.^3)*(lambda(k).^5*(n_eff(k+2)-3*n_eff(k+1)+3*n_eff(k)-n_eff(k-1))/del_lambda^3....
                             +3*lambda(k).^4*(n_eff(k+2)-2*n_eff(k+1)+n_eff(k))/del_lambda^2);		% [Unit:ps^3/km]
end

Beta04 = zeros(1,N);
for k = 3:N-2
  Beta04(k) = 1/(8*pi^3*c.^4)*(lambda(k).^7*(n_eff(k+2)-4*n_eff(k+1)+6*n_eff(k)-4*n_eff(k-1)+n_eff(k-2))/del_lambda^4....
                            +8*lambda(k).^6*(n_eff(k+2)-3*n_eff(k+1)+3*n_eff(k)-n_eff(k-1))/del_lambda^3....
                            +12*lambda(k).^5*(n_eff(k+2)-2*n_eff(k+1)+n_eff(k))/del_lambda^2);		% [Unit:ps^4/km]
end

Beta05 = zeros(1,N);
for k = 3:N-3
  Beta05(k) = -1/(16*pi^4*c.^5)*(lambda(k).^9*(n_eff(k+3)-5*n_eff(k+2)+10*n_eff(k+1)-10*n_eff(k)+5*n_eff(k-1)-n_eff(k-2))/del_lambda^5....
                               +15*lambda(k).^8*(n_eff(k+3)-4*n_eff(k+2)+6*n_eff(k+1)-4*n_eff(k)+n_eff(k-1))/del_lambda^4....
                               +60*lambda(k).^7*(n_eff(k+3)-3*n_eff(k+2)+3*n_eff(k+1)-n_eff(k))/del_lambda^3....
                               +60*lambda(k).^6*(n_eff(k+3)-2*n_eff(k+2)+n_eff(k+1))/del_lambda^2);	% [Unit:ps^5/km]
end


Beta06 = zeros(1,N);
for k = 4:N-3
  Beta06(k) = 1/(32*pi^5*c.^6)*(lambda(k).^11*(n_eff(k+3)-6*n_eff(k+2)+15*n_eff(k+1)-20*n_eff(k)+15*n_eff(k-1)-6*n_eff(k-2)+n_eff(k-3))/del_lambda^6....
                              +24*lambda(k).^10*(n_eff(k+3)-5*n_eff(k+2)+10*n_eff(k+1)-10*n_eff(k)+5*n_eff(k-1)-n_eff(k-2))/del_lambda^5....
                              +180*lambda(k).^9*(n_eff(k+3)-4*n_eff(k+2)+6*n_eff(k+1)-4*n_eff(k)+n_eff(k-1))/del_lambda^4....
                              +480*lambda(k).^8*(n_eff(k+3)-3*n_eff(k+2)+3*n_eff(k+1)-n_eff(k))/del_lambda^3....
                              +360*lambda(k).^7*(n_eff(k+3)-2*n_eff(k+2)+n_eff(k+1))/del_lambda^2);	% [Unit:ps^6/km]
end


Beta07 = zeros(1,N);
for k = 4:N-4
  Beta07(k) = -1/(64*pi^6*c.^7)*(lambda(k).^13*(n_eff(k+4)-7*n_eff(k+3)+21*n_eff(k+2)-35*n_eff(k+1)+35*n_eff(k)-21*n_eff(k-1)+7*n_eff(k-2)-n_eff(k-3))/del_lambda^7....
                              +35*lambda(k).^12*(n_eff(k+4)-6*n_eff(k+3)+15*n_eff(k+2)-20*n_eff(k+1)+15*n_eff(k)-6*n_eff(k-1)+n_eff(k-2))/del_lambda^6....
                              +420*lambda(k).^11*(n_eff(k+4)-5*n_eff(k+3)+10*n_eff(k+2)-10*n_eff(k+1)+5*n_eff(k)-n_eff(k-1))/del_lambda^5....
                              +2100*lambda(k).^10*(n_eff(k+4)-4*n_eff(k+3)+6*n_eff(k+2)-4*n_eff(k+1)+n_eff(k))/del_lambda^4....
                              +4000*lambda(k).^9*(n_eff(k+4)-3*n_eff(k+3)+3*n_eff(k+2)-n_eff(k+1))/del_lambda^3....
                              +2520*lambda(k).^8*(n_eff(k+4)-2*n_eff(k+3)+n_eff(k+2))/del_lambda^2);	% [Unit:ps^7/km]
end

Beta08 = zeros(1,N);
for k = 5:N-4
  Beta08(k) = 1/(128*pi^7*c.^8)...
             *(lambda(k).^15*(n_eff(k+4)-8*n_eff(k+3)+28*n_eff(k+2)-56*n_eff(k+1)+70*n_eff(k)-56*n_eff(k-1)+28*n_eff(k-2)-8*n_eff(k-3)+n_eff(k-4))/del_lambda^8....
             +48*lambda(k).^14*(n_eff(k+4)-7*n_eff(k+3)+21*n_eff(k+2)-35*n_eff(k+1)+35*n_eff(k)-21*n_eff(k-1)+7*n_eff(k-2)-n_eff(k-3))/del_lambda^7....
             +840*lambda(k).^13*(n_eff(k+4)-6*n_eff(k+3)+15*n_eff(k+2)-20*n_eff(k+1)+15*n_eff(k)-6*n_eff(k-1)+n_eff(k-2))/del_lambda^6....
             +6720*lambda(k).^12*(n_eff(k+4)-5*n_eff(k+3)+10*n_eff(k+2)-10*n_eff(k+1)+5*n_eff(k)-n_eff(k-1))/del_lambda^5....
             +25000*lambda(k).^11*(n_eff(k+4)-4*n_eff(k+3)+6*n_eff(k+2)-4*n_eff(k+1)+n_eff(k))/del_lambda^4....
             +38520*lambda(k).^10*(n_eff(k+4)-3*n_eff(k+3)+3*n_eff(k+2)-n_eff(k+1))/del_lambda^3....
             +20160*lambda(k).^9*(n_eff(k+4)-2*n_eff(k+3)+n_eff(k+2))/del_lambda^2);	% [Unit:ps^8/km]
end


Beta09 = zeros(1,N);
for k = 5:N-5
  Beta09(k) = -1/(256*pi^8*c.^9)...
             *(lambda(k).^17*(n_eff(k+5)-9*n_eff(k+4)+36*n_eff(k+3)-84*n_eff(k+2)+126*n_eff(k+1)-126*n_eff(k)+84*n_eff(k-1)-36*n_eff(k-2)+9*n_eff(k-3)-n_eff(k-4))/del_lambda^9....
	         +63*lambda(k).^16*(n_eff(k+5)-8*n_eff(k+4)+28*n_eff(k+3)-56*n_eff(k+2)+70*n_eff(k+1)-56*n_eff(k)+28*n_eff(k-1)-8*n_eff(k-2)+n_eff(k-3))/del_lambda^8....
             +1512*lambda(k).^15*(n_eff(k+5)-7*n_eff(k+4)+21*n_eff(k+3)-35*n_eff(k+2)+35*n_eff(k+1)-21*n_eff(k)+7*n_eff(k-1)-n_eff(k-2))/del_lambda^7....
             +17640*lambda(k).^14*(n_eff(k+5)-6*n_eff(k+4)+15*n_eff(k+3)-20*n_eff(k+2)+15*n_eff(k+1)-6*n_eff(k)+n_eff(k-1))/del_lambda^6....
             +105640*lambda(k).^13*(n_eff(k+5)-5*n_eff(k+4)+10*n_eff(k+3)-10*n_eff(k+2)+5*n_eff(k+1)-n_eff(k))/del_lambda^5....
             +313520*lambda(k).^12*(n_eff(k+5)-4*n_eff(k+4)+6*n_eff(k+3)-4*n_eff(k+2)+n_eff(k+1))/del_lambda^4....
             +405360*lambda(k).^11*(n_eff(k+5)-3*n_eff(k+4)+3*n_eff(k+3)-n_eff(k+2))/del_lambda^3....
             +181440*lambda(k).^10*(n_eff(k+5)-2*n_eff(k+4)+n_eff(k+3))/del_lambda^2);	% [Unit:ps^9/km]
end


Beta10 = zeros(1,N);
for k = 6:N-5
  Beta10(k) = 1/(512*pi^9*c.^10)...
             *(lambda(k).^19*(n_eff(k+5)-10*n_eff(k+4)+45*n_eff(k+3)-120*n_eff(k+2)+210*n_eff(k+1)-252*n_eff(k)+210*n_eff(k-1)-120*n_eff(k-2)+45*n_eff(k-3)-10*n_eff(k-4)+n_eff(k-5))/del_lambda^10....
             +80*lambda(k).^18*(n_eff(k+5)-9*n_eff(k+4)+36*n_eff(k+3)-84*n_eff(k+2)+126*n_eff(k+1)-126*n_eff(k)+84*n_eff(k-1)-36*n_eff(k-2)+9*n_eff(k-3)-n_eff(k-4))/del_lambda^9....
	         +2520*lambda(k).^17*(n_eff(k+5)-8*n_eff(k+4)+28*n_eff(k+3)-56*n_eff(k+2)+70*n_eff(k+1)-56*n_eff(k)+28*n_eff(k-1)-8*n_eff(k-2)+n_eff(k-3))/del_lambda^8....
             +40320*lambda(k).^16*(n_eff(k+5)-7*n_eff(k+4)+21*n_eff(k+3)-35*n_eff(k+2)+35*n_eff(k+1)-21*n_eff(k)+7*n_eff(k-1)-n_eff(k-2))/del_lambda^7....
             +352600*lambda(k).^15*(n_eff(k+5)-6*n_eff(k+4)+15*n_eff(k+3)-20*n_eff(k+2)+15*n_eff(k+1)-6*n_eff(k)+n_eff(k-1))/del_lambda^6....
             +1686840*lambda(k).^14*(n_eff(k+5)-5*n_eff(k+4)+10*n_eff(k+3)-10*n_eff(k+2)+5*n_eff(k+1)-n_eff(k))/del_lambda^5....
             +4167600*lambda(k).^13*(n_eff(k+5)-4*n_eff(k+4)+6*n_eff(k+3)-4*n_eff(k+2)+n_eff(k+1))/del_lambda^4....
             +4640400*lambda(k).^12*(n_eff(k+5)-3*n_eff(k+4)+3*n_eff(k+3)-n_eff(k+2))/del_lambda^3....
             +1814400*lambda(k).^11*(n_eff(k+5)-2*n_eff(k+4)+n_eff(k+3))/del_lambda^2);	% [Unit:ps^10/km]
end


D=D';

betas=[0,Beta02(N_pump),Beta03(N_pump),Beta04(N_pump),Beta05(N_pump),Beta06(N_pump),Beta07(N_pump),Beta08(N_pump),Beta09(N_pump),Beta10(N_pump)];
betas= betas*1e-3;
end
